!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){var b=function(){function c(){var Y=this,N=function(){var d=["br-wrapper"];""!==Y.options.theme&&d.push("br-theme-"+Y.options.theme),Y.$elem.wrap(a("<div />",{"class":d.join(" ")}))},U=function(){Y.$elem.unwrap()},ac=function(d){return a.isNumeric(d)&&(d=Math.floor(d)),a('option[value="'+d+'"]',Y.$elem)},J=function(){var d=Y.options.initialRating;return d?ac(d):a("option:selected",Y.$elem)},L=function(d){var e=Y.$elem.data("barrating");return"undefined"!=typeof d?e[d]:e},Q=function(d,e){null!==e&&"object"==typeof e?Y.$elem.data("barrating",e):Y.$elem.data("barrating")[d]=e},H=function(){var e=J(),f=e.val(),d=e.data("html")?e.data("html"):e.text();Q(null,{userOptions:Y.options,ratingValue:f,ratingText:d,originalRatingValue:f,originalRatingText:d,readOnly:Y.options.readonly,ratingMade:!1})},G=function(){Y.$elem.removeData("barrating")},Z=function(){return L("ratingText")},aa=function(){return L("ratingValue")},X=function(){var d=a("<div />",{"class":"br-widget"});return Y.$elem.find("option").each(function(){var f,e,g,h;f=a(this).val(),f&&(e=a(this).text(),g=a(this).data("html"),g&&(e=g),h=a("<a />",{href:"#","data-rating-value":f,"data-rating-text":e,html:Y.options.showValues?e:""}),d.append(h))}),Y.options.showSelectedRating&&d.append(a("<div />",{text:"","class":"br-current-rating"})),Y.options.reverse&&d.addClass("br-reverse"),Y.options.readonly&&d.addClass("br-readonly"),d},W=function(){return L("userOptions").reverse?"nextAll":"prevAll"},K=function(d){ac(d).prop("selected",!0),Y.$elem.change()},V=function(){a("option",Y.$elem).prop("selected",function(){return this.defaultSelected}),Y.$elem.change()},F=function(d){d=d?d:Z(),Y.options.showSelectedRating&&Y.$elem.parent().find(".br-current-rating").text(d)},P=function(d){return Math.round(Math.floor(10*d)/10%1*100)},ab=function(){Y.$widget.find("a").removeClass(function(d,f){return(f.match(/(^|\s)br-\S+/g)||[]).join(" ")})},q=function(){var j,f,e=Y.$widget.find('a[data-rating-value="'+aa()+'"]'),h=L("userOptions").initialRating,d=a.isNumeric(aa())?aa():0,g=P(h);if(ab(),e.addClass("br-selected br-current")[W()]().addClass("br-selected"),!L("ratingMade")&&a.isNumeric(h)){if(d>=h||!g){return}j=Y.$widget.find("a"),f=e.length?e[L("userOptions").reverse?"prev":"next"]():j[L("userOptions").reverse?"last":"first"](),f.addClass("br-fractional"),f.addClass("br-fractional-"+g)}},E=function(d){return Y.options.deselectable?Y.$elem.find("option:first").val()?!1:aa()==d.attr("data-rating-value"):!1},B=function(d){d.on("click.barrating",function(j){var f,e,h=a(this),g=L("userOptions");return j.preventDefault(),f=h.attr("data-rating-value"),e=h.attr("data-rating-text"),E(h)&&(f="",e=""),Q("ratingValue",f),Q("ratingText",e),Q("ratingMade",!0),K(f),F(e),q(),g.onSelect.call(Y,aa(),Z(),j),!1})},D=function(d){d.on("mouseenter.barrating",function(){var f=a(this);ab(),f.addClass("br-active")[W()]().addClass("br-active"),F(f.attr("data-rating-text"))})},I=function(d){Y.$widget.on("mouseleave.barrating blur.barrating",function(){F(),q()})},z=function(d){d.on("touchstart.barrating",function(f){f.preventDefault(),f.stopPropagation(),a(this).click()})},t=function(d){d.on("click.barrating",function(e){e.preventDefault()})},k=function(d){B(d),Y.options.hoverState&&(D(d),I(d))},T=function(d){d.off(".barrating")},A=function(d){$elements=Y.$widget.find("a"),z&&z($elements),d?(T($elements),t($elements)):k($elements)};this.show=function(){L()||(N(),H(),Y.$widget=X(),Y.$widget.insertAfter(Y.$elem),q(),F(),A(Y.options.readonly),Y.$elem.hide())},this.readonly=function(d){"boolean"==typeof d&&L("readOnly")!=d&&(A(d),Q("readOnly",d),Y.$widget.toggleClass("br-readonly"))},this.set=function(d){var e=L("userOptions");Y.$elem.find('option[value="'+d+'"]').val()&&(Q("ratingValue",d),Q("ratingText",Y.$elem.find('option[value="'+d+'"]').text()),Q("ratingMade",!0),K(aa()),F(Z()),q(),e.silent||e.onSelect.call(this,aa(),Z()))},this.clear=function(){var d=L("userOptions");Q("ratingValue",L("originalRatingValue")),Q("ratingText",L("originalRatingText")),Q("ratingMade",!1),V(),F(Z()),q(),d.onClear.call(this,aa(),Z())},this.destroy=function(){var e=aa(),f=Z(),d=L("userOptions");T(Y.$widget.find("a")),Y.$widget.remove(),G(),U(),Y.$elem.show(),d.onDestroy.call(this,e,f)}}return c.prototype.init=function(d,f){return this.$elem=a(f),this.options=a.extend({},a.fn.barrating.defaults,d),this.options},c}();a.fn.barrating=function(d,c){return this.each(function(){var e=new b;if(a(this).is("select")||a.error("Sorry, this plugin only works with select fields."),e.hasOwnProperty(d)){if(e.init(c,this),"show"===d){return e.show(c)}if(e.$elem.data("barrating")){return e.$widget=a(this).next(".br-widget"),e[d](c)}}else{if("object"==typeof d||!d){return c=d,e.init(c,this),e.show()}a.error("Method "+d+" does not exist on jQuery.barrating")}})},a.fn.barrating.defaults={theme:"",initialRating:null,showValues:!1,showSelectedRating:!0,deselectable:!0,reverse:!1,readonly:!1,fastClicks:!0,hoverState:!0,silent:!1,onSelect:function(c,d,f){},onClear:function(c,d){},onDestroy:function(c,d){}},a.fn.barrating.BarRating=b});